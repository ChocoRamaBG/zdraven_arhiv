name: Zdraven Arhiv Scraper üè•

on:
  workflow_dispatch: 
  # schedule: # –ê–∫–æ –∏—Å–∫–∞—à –¥–∞ —Å–µ –ø—É—Å–∫–∞ —Å–∞–º –≤—Å–µ–∫–∏ –¥–µ–Ω –≤ 2 –ø—Ä–µ–∑ –Ω–æ—â—Ç–∞, –º–∞—Ö–Ω–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä–∞ –¥–æ–ª—É
  #   - cron: '0 2 * * *'

# üëá –¢–û–í–ê –ï –í–ê–ñ–ù–û, –õ–¨–û–õ–¨–û! –î–∞–≤–∞–º–µ –ø—Ä–∞–≤–∞ –∑–∞ –ø–∏—Å–∞–Ω–µ!
permissions:
  contents: write

jobs:
  scrape-doctors:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout repo content
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9'

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run Scraper üöÄ
        # –°–∫—Ä–∏–ø—Ç—ä—Ç —â–µ —Å—ä–∑–¥–∞–¥–µ zdraven_arhiv_data.xlsx
        run: python scraper.py

      # üëá –ï–¢–û –ì–û –ú–ê–ì–ò–ß–ï–°–ö–ò–Ø–¢ –¢–†–ò–ö –ó–ê GIT PUSH
      - name: Commit and Push Data üíæ
        run: |
          git config --global user.name 'GitHub Actions Bot'
          git config --global user.email 'actions@github.com'
          # –î–æ–±–∞–≤—è–º–µ –≤—Å–∏—á–∫–∏ excel —Ñ–∞–π–ª—á–æ–≤—Ü–∏
          git add *.xlsx
          # –ê–∫–æ –Ω—è–º–∞ –ø—Ä–æ–º–µ–Ω–∏, –Ω–µ –≥—ä—Ä–º–∏, –∞ –ø—Ä–æ—Å—Ç–æ –∫–∞–∂–∏ "–Ω—è–º–∞ –Ω–∏—â–æ –Ω–æ–≤–æ"
          git commit -m "Auto-update database: $(date)" || echo "No changes to commit"
          git push
